knitr::opts_chunk$set(echo = TRUE)
copiers <- read.csv("copiers.csv")
str(copiers)
plot(copiers$Sales, copiers$Profit)
cor(copiers$Sales, copiers$Profit)
copiers$Sales
boxplot(copiers$Sales)
boxplot(copiers$Sales, plot = F)$out
# To get the outlier value:
sales_out <- boxplot(copiers$Sales, plot = F)$out
copiers[copiers$Sales == sales_out, ]
copiers[-c(copiers$Sales == sales_out), ]
copiers[-c(copiers$Sales %in% sales_out), ]
# To get the outlier value:
sales_out <- boxplot(copiers$Sales, plot = F)$out
copiers_clean <- copiers[-c(copiers$Sales %in% sales_out), ]
copiers$Sales %in% sales_out
-c(copiers$Sales %in% sales_out)
copiers[-c(copiers$Sales %in% sales_out), ]
boxplot(copiers_clean$Sales, copiers_clean$Profit)
plot(copiers_clean$Sales, copiers_clean$Profit)
plot(copiers_clean$Sales, copiers_clean$Profit)
# To get the outlier value:
sales_out <- boxplot(copiers$Sales, plot = F)$out
copiers_clean <- copiers[-c(copiers$Sales %in% sales_out), ]
plot(copiers_clean$Sales, copiers_clean$Profit)
copiers_clean <- copiers[-c(copiers$Sales %in% sales_out), ]
plot(copiers_clean$Sales, copiers_clean$Profit)
copiers_clean <- copiers[-c(copiers$Sales %in% sales_out), ]
model_rm <- lm(formula = Profit~Sales, data=copiers_clean)
summary(model_rm)
model_rm <- lm(formula = Profit~Sales, data=copiers_clean)
summary(model_rm)
copiers_clean <- copiers[-c(copiers$Sales == sales_out), ]
cor(copiers$Sales, copiers$Profit)
model_rm <- lm(formula = Profit~Sales, data=copiers_clean)
model_rm <- lm(formula = Profit~Sales, data=copiers_clean)
plot(copiers_clean$Sales, copiers_clean$Profit)
copiers_clean <- copiers[-c(copiers$Sales %in% sales_out), ]
copiers_clean <- copiers[copiers$Sales<4000, ]
cor(copiers$Sales, copiers$Profit)
model_rm <- lm(formula = Profit~Sales, data=copiers_clean)
summary(model_rm)
plot(copiers_clean$Sales, copiers_clean$Profit)
abline(a = -83.54810, b = 0.39444)
copiers_clean_which <- copiers[-which(copiers$Sales %in% 4000), ]
copiers_clean_which <- copiers[-which(copiers$Sales %in% sales_out), ]
copiers_clean == copiers_clean_which
abline(model_rm)
plot(copiers_clean$Sales, copiers_clean$Profit)
abline(model_rm)
abline(a = -83.54810, b = 0.39444) == abline(model_rm)
plot(copiers_clean$Sales, copiers_clean$Profit)
abline(a = -83.54810, b = 0.39444) == abline(model_rm)
plot(copiers_clean$Sales, copiers_clean$Profit)
abline(model_rm)
profit_temp <- -83.54810 + 0.39444 * 350
profit_temp
profit_temp <- -83.54810 + 0.39444 * 245
profit_temp
sales_temp <- c(245, 370, 210, 400)
profit_temp <- -83.54810 + 0.39444 * sales_temp
profit_temp
```{r, echo = F}
sales_temp <- c(245, 370, 210, 400)
profit_temp <- -83.54810 + 0.39444 * sales_temp
predict(object = model_rm, newdata = data.frame(Sales = c(245, 370, 210, 400)))
new_copiers <- data.frame(
Sales = c(300, 450, 750, 10)
)
predict(object = model_rm, newdata = new_copiers)
new_copiers <- data.frame(
Sales = c(300, 450, 750, 10)
)
pre_new_copiers <- predict(object = model_rm, newdata = new_copiers)
predict(model_rm, copiers_clean)
pre_copiers_clean <- predict(model_rm, copiers_clean)
pre_copiers <- predict(model_rm, copiers)
pre_copiers - copiers$Sales
16 + 49 + 64 + 25 + 25
16 + 49 + 64 + 25 + 25 / 5
16 + 49 + 64 + 25 + 25 / 5
16 + 49 + 64 + 25 + 25 / 5
16 + 49 + 64 + 25 + 25 / 5
16 + 49 + 64 + 25 + 25 / 5
(16 + 49 + 64 + 25 + 25) / 5
mean(16,49,64,25,25)
mean(16,49,64,25,25)
# pre_copiers - copiers$Sales
knitr::opts_chunk$set(echo = TRUE)
copiers <- read.csv("copiers.csv")
copiers_clean <- copiers[copiers$Sales<4000,]
model1_rm <- lm(formula = Profit~Sales, data=copiers)
model2_rm <- lm(formula = Profit~Sales, data=copiers_clean)
sum(model1_rm)
summary(model2_rm)
summary(model1_rm)
summary(model2_rm)
plot(copiers$Sales, copiers$Profit)
plot(copiers$Sales, copiers$Profit)
abline(model1_rm, col = "red")
plot(copiers$Sales, copiers$Profit)
abline(model1_rm, col = "red")
abline(model2_rm, col = "blue")
library(dplyr)
crime <- read.csv("data_input/crime.csv") %>%
dplyr::select(-X)
names(crime) <- c("percent_m", "is_south", "mean_education", "police_exp60", "police_exp59", "labour_participation", "m_per1000f", "state_pop", "nonwhites_per1000", "unemploy_m24", "unemploy_m39", "gdp", "inequality", "prob_prison", "time_prison", "crime_rate")
plot(crime$gdp, crime$inequality)
#plot(crime$gdp, crime$inequality)
head(crime)
library(GGally)
library(GGally, warn.conflicts = F)
ggcorr(crime, label = T, label_size = 3, hjust = 1)
library(dplyr)
library(dplyr)
crime <- read.csv("data_input/crime.csv") %>%
dplyr::select(-X)
names(crime) <- c("percent_m", "is_south", "mean_education", "police_exp60", "police_exp59", "labour_participation", "m_per1000f", "state_pop", "nonwhites_per1000", "unemploy_m24", "unemploy_m39", "gdp", "inequality", "prob_prison", "time_prison", "crime_rate")
#plot(crime$gdp, crime$inequality)
head(crime)
crime_model1 <- lm(formula = inequality~gdp, crime)
summary(crime_model1)
cor(crime$inequality, crime$gdp)
summary(crime_model1)
crime_model1 <- lm(formula = inequality~gdp+nonwhites_per1000, crime)
crime_model1 <- lm(formula = inequality~gdp, crime)
summary(crime_model1)
crime_model2 <- lm(formula = inequality~gdp+nonwhites_per1000, crime)
plot(crime_model2)
crime_model3 <- lm(formula = inequality~gdp+nonwhite_per1000+mean_education, crime)
crime_model3 <- lm(formula = inequality~gdp+nonwhites_per1000+mean_education, crime)
crime_model3
crime_model3 <- lm(formula = inequality~gdp+nonwhites_per1000+mean_education, crime)
summary(crime_model3)
summary(crime_model2)
crime_model3 <- lm(formula = inequality~gdp+nonwhites_per1000+mean_education, crime)
summary(crime_model1)$r.square
summary(crime_model2)$r.square
summary(crime_model3)$r.square
crime_model4 <- lm(inequality~.,crime)
summary(crime_model4)
plot(crime_model4)
library(dplyr)
crime <- read.csv("data_input/crime.csv") %>% select(-X)
names(crime) <- c("percent_m", "is_south", "mean_education", "police_exp60", "police_exp59", "labour_participation", "m_per1000f", "state_pop", "nonwhites_per1000", "unemploy_m24", "unemploy_m39", "gdp", "inequality", "prob_prison", "time_prison", "crime_rate")
summary(crime)
model <- lm(inequality~gdp,crime)
summary(model)
predict(object = model, newdata = data.frame(gdp = 600))
round(predict(object = model, newdata = data.frame(gdp = 600)),2)
install.packages("MLmetrics")
library(MLmetrics, warn.conflicts = F)
pred <- predict(crime_model3, crime)
pred
plot(pred)
abline(crime_model3)
pred <- predict(crime_model3, crime)
plot(pred)
abline(crime_model3)
MAE(pred, crime$inequality)
mean(pred - crime$inequality^2)
MAE(pred, crime$inequality)
mean((pred - crime$inequality)^2)
mean((pred - crime$inequality)^2)
MAE(pred, crime$inequality)
mean((pred - crime$inequality)^2)
MAE(pred, crime$inequality)
MSE(pred, crime$inequality)
sqrt(mean((pred - crime$inequality)^2))
RMSE(pred, crime$inequality)
MAPE(pred, crime$inequality)
predict(model, data.frame(gdp = 600), interval = "confidence", level = 0.9)
predict(model, data.frame(gdp = 600), interval = "confidence", level = 1)
predict(model, data.frame(gdp = 600), interval = "confidence", level = 2)
predict(model, data.frame(gdp = 600), interval = "confidence", level = 1)
